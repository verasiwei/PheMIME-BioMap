jak2_dat = readRDS(paste0("/proj/PI_SAVONA/Projects/CHIP_PheWAS/.common/data/92k/","intensity_JAK2_92k.rds")) %>%
dplyr::filter(group == "JAK2 V617F carrier") %>%
dplyr::select(grid)
library(tidyverse)
jak2_dat = readRDS(paste0("/proj/PI_SAVONA/Projects/CHIP_PheWAS/.common/data/92k/","intensity_JAK2_92k.rds")) %>%
dplyr::filter(group == "JAK2 V617F carrier") %>%
dplyr::select(grid)
library(PheGenHelper)
library(phewasHelper)
library(future)
##phenotype files
initiate_database(phe_exclude = T, demo = T, phe_timeline = T)
extract_grid(phe=F, phe_exclude = T,demo_dat, jak2_dat)
phe_dat_exclude = phe_dat_exclude[phe_dat_exclude@Dimnames[[1]] %in% demo_dat$grid,]
demo_dat = demo_dat[demo_dat$grid %in% phe_dat_exclude@Dimnames[[1]],]
phe_dat_exclude_long = wide_to_long(phe_dat_exclude,type="phecode") %>%
mutate(phecode = substring(phecode, 2, length(phecode))) %>%
mutate(phecode = normalize_phecodes(phecode)) %>%
arrange(grid)
saveRDS(phe_dat_exclude_long,file="JAK2_carriers_phe_dat_long.rds")
write.table(phe_dat_exclude_long,file = "jak2_carriers_phe_dat_long.csv",col.names = T,row.names = F,sep = ",",quote = F)
setwd("~/paper_draft_prepare/omics_multimorbidity/test")
getwd()
reticulate::repl_python()
